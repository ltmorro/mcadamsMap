#!/usr/bin/python3.5

import dijkstar as dj
import collections
import itertools

class Model(object):
    def __init__(self):
        self.graph = dj.Graph()
        #first floor graph nodes
        self.initFirstFloor(self.graph)
        #second floor graph nodes
        self.initSecondFloor(self.graph)
        #third floor graph nodes
        self.initThirdFloor(self.graph)

    def initFirstFloor(self, graph):
        graph.add_node("101", neighbors={"102":1, "103":1, "hall4":1})
        graph.add_node("102", neighbors={"104":1, "101":1})
        graph.add_node("103", neighbors={"101":1, "104":1})
        graph.add_node("104", neighbors={"102":1, "103":1, "106":1})
        graph.add_node("105", neighbors={"103":1, "106":1, "107":1})
        graph.add_node("106", neighbors={"104":1, "105":1, "108":1})
        graph.add_node("107", neighbors={"105":1, "108":1})
        graph.add_node("108", neighbors={"106":1, "107":1, "hall2":1})
        graph.add_node("109", neighbors={"110A":1, "hall1":1})
        graph.add_node("hall1", neighbors={"109":1, "stairs1":1, "hall2":1})
        graph.add_node("stairs1", neighbors={"201":1, "hall1":1})
        graph.add_node("hall2", neighbors={"hall1":1, "male_1":1, "108":1})
        graph.add_node("hall3", neighbors={"female_1":1, "111":1, "112":1})
        graph.add_node("110A", neighbors={"109":1, "110B":1})
        graph.add_node("110B", neighbors={"110A":1, "110C":1})
        graph.add_node("110C", neighbors={"110B":1, "110D":1})
        graph.add_node("110D", neighbors={"110C":1, "110E":1})
        graph.add_node("110E", neighbors={"110D":1})
        graph.add_node("male_1", neighbors={"hall1":1, "female_1":1, "hall2":1})
        graph.add_node("female_1", neighbors={"male_1":1, "hall3":1})
        graph.add_node("111", neighbors={"hall3":1, "113":1})
        graph.add_node("112", neighbors={"114":1, "hall3":1, "hall5":1})
        graph.add_node("113", neighbors={"111":1, "115":1})
        graph.add_node("115", neighbors={"113":1, "116":1})
        graph.add_node("116", neighbors={"115":1, "stairs2":1, "hall4":1})
        graph.add_node("hall4", neighbors={"116":1, "101":1})
        graph.add_node("114", neighbors={"112":1})
        graph.add_node("117A", neighbors={"117C":1, "hall5":1})
        graph.add_node("117C", neighbors={"117A":1})
        graph.add_node("117B", neighbors={"120":1, "male_1_2":1})
        graph.add_node("120", neighbors={"117B":1})
        graph.add_node("hall5", neighbors={"112":1, "hall6":1, "117A":1})
        graph.add_node("hall6", neighbors={"hall5":1, "118A":1, "stairs3":1})
        graph.add_node("hall7", neighbors={"123B":1, "stairs3":1, "123A":1, "122":1})
        graph.add_node("118A", neighbors={"hall6":1, "118B":1, "118C":1, "118D":1, "stairs3":1})
        graph.add_node("118B", neighbors={"118A":1})
        graph.add_node("118C", neighbors={"118A":1})
        graph.add_node("118D", neighbors={"118A":1})
        graph.add_node("male_1_2", neighbors={"117B":1, "121":1, "122":1})
        graph.add_node("122", neighbors={"male_1_2":1, "123A":1, "hall7":1})
        graph.add_node("124A", neighbors={"124B":1, "125":1})
        graph.add_node("124B", neighbors={"124A":1, "131":1})
        graph.add_node("female_1_2", neighbors={"126":1, "133":1})
        graph.add_node("126", neighbors={"female_1_2":1, "137":1})
        graph.add_node("137", neighbors={"126":1, "135":1})
        graph.add_node("135", neighbors={"137":1, "126":1})
        graph.add_node("133", neighbors={"135":1, "121":1, "stairs4":1, "female_1_2":1})
        graph.add_node("131", neighbors={"133":1, "129":1, "124B":1})
        graph.add_node("129", neighbors={"131":1, "127":1})
        graph.add_node("127", neighbors={"129":1, "125":1})
        graph.add_node("125", neighbors={"127":1, "123B":1, "124A":1})
        graph.add_node("123B", neighbors={"125":1, "123A":1, "122":1, "hall7":1})
        graph.add_node("123A", neighbors={"hall7":1, "121":1, "122":1})
        graph.add_node("121", neighbors={"119":1, "male_1_2":1, "123A":1})
        graph.add_node("119", neighbors={"121":1})
        graph.add_node("stairs1", neighbors={"hall1":1, "stairs1_2":1})
        graph.add_node("stairs2", neighbors={"116":1, "stairs2_2":1})
        graph.add_node("stairs3", neighbors={"hall6":1, "stairs3_2":1, "hall7":1})
        graph.add_node("stairs4", neighbors={"133":1, "stairs4_2":1})


    def initSecondFloor(self, graph):
        graph.add_node("201", neighbors={"stairs1_2":1, "203":1, "female_2":1})
        graph.add_node("female_2", neighbors={"201":1, "male_2":1})
        graph.add_node("male_2", neighbors={"female_2":1, "220":2})
        graph.add_node("202A", neighbors={"219":1})
        graph.add_node("202B", neighbors={"203":1, "202C":1})
        graph.add_node("202C", neighbors={"202B":1})
        graph.add_node("203", neighbors={"201":1, "204":1, "202B":1})
        graph.add_node("204", neighbors={"203":1, "205":1})
        graph.add_node("205", neighbors={"204":1, "207":1})
        graph.add_node("206", neighbors={"207":1})
        graph.add_node("207", neighbors={"205":1, "206":1, "208":1})
        graph.add_node("208", neighbors={"207":1, "209":1})
        graph.add_node("209", neighbors={"208":1, "210":1})
        graph.add_node("210", neighbors={"209":1, "211":1})
        graph.add_node("211", neighbors={"210":1, "212":1})
        graph.add_node("212", neighbors={"211":1, "214":1})
        graph.add_node("214", neighbors={"213":1, "212":1, "215":1})
        graph.add_node("213", neighbors={"214":1, "stairs2_2":1})
        graph.add_node("215", neighbors={"214":1, "217":1, "216":1})
        graph.add_node("216", neighbors={"215":1})
        graph.add_node("217", neighbors={"215":1, "218":1})
        graph.add_node("218", neighbors={"217":1, "219":1})
        graph.add_node("219", neighbors={"220":1, "218":1, "202A":1})
        graph.add_node("220", neighbors={"219":1, "male_2":2})
        graph.add_node("230", neighbors={"hall2_2":1, "stairs4_2":1})
        graph.add_node("hall2_2", neighbors={"230":1, "232":1})
        graph.add_node("232", neighbors={"hall2_2":1, "231":1})
        graph.add_node("231", neighbors={"232":1, "229":1})
        graph.add_node("229", neighbors={"231":1, "227":1, "228":1})
        graph.add_node("228", neighbors={"229":1, "226":1})
        graph.add_node("226", neighbors={"228":1, "227":1, "224":1})
        graph.add_node("224", neighbors={"226":1, "223":1})
        graph.add_node("227", neighbors={"229":1, "225":1, "226":1})
        graph.add_node("225", neighbors={"227":1, "226":1,"223":1})
        graph.add_node("223", neighbors={"225":1, "224":1, "hall1_2":1})
        graph.add_node("221", neighbors={"hall1_2":1, "221A":1, "222":1})
        graph.add_node("hall1_2", neighbors={"221":1, "222":1, "223":1})
        graph.add_node("221A", neighbors={"221":1})
        graph.add_node("222", neighbors={"hall1_2":1, "222A":1, "stairs_3_2":1})
        graph.add_node("222A", neighbors={"222":1})
        graph.add_node("stairs1_2", neighbors={"stairs1":1, "201":1, "stairs1_3":1})
        graph.add_node("stairs2_2", neighbors={"stairs2":1, "213":1, "stairs2_3":1})
        graph.add_node("stairs3_2", neighbors={"222":1, "stairs3":1})
        graph.add_node("stairs4_2", neighbors={"230":1, "stairs4":1})

    def initThirdFloor(self, graph):
        graph.add_node("301", neighbors={"302":1, "stairs1_3":1})
        graph.add_node("302", neighbors={"301":1, "303":1,"female_3":1})
        graph.add_node("female_3", neighbors={"302":1, "male_3":1})
        graph.add_node("male_3", neighbors={"female_3":1, "319":2})
        graph.add_node("304A", neighbors={"318":1})
        graph.add_node("304B", neighbors={"315":1})
        graph.add_node("304C", neighbors={"307":1})
        graph.add_node("304D", neighbors={"303":1})
        graph.add_node("303", neighbors={"302":1, "305":1, "304D":1})
        graph.add_node("305", neighbors={"303":1, "306":1})
        graph.add_node("306", neighbors={"305":1, "307":1})
        graph.add_node("307", neighbors={"306":1, "308":1, "304C":1})
        graph.add_node("308", neighbors={"307":1, "309":1})
        graph.add_node("309", neighbors={"308":1, "310":1})
        graph.add_node("310", neighbors={"309":1, "311":1})
        graph.add_node("311", neighbors={"310":1, "312":1})
        graph.add_node("312", neighbors={"311":1, "314":1})
        graph.add_node("314", neighbors={"313":1, "312":1, "315":1})
        graph.add_node("313", neighbors={"314":1, "stairs2_3":1})
        graph.add_node("315", neighbors={"314":1, "316":1, "304B":1})
        graph.add_node("316", neighbors={"315":1, "317":1})
        graph.add_node("317", neighbors={"316":1, "318":1})
        graph.add_node("318", neighbors={"317":1, "319":1, "304A":1})
        graph.add_node("319", neighbors={"318":1, "male_3":2})
        graph.add_node("stairs1_3", neighbors={"stairs1_2":1, "301":1})
        graph.add_node("stairs2_3", neighbors={"stairs2_2":1, "313":1})


    def findShortest(self, source, dest):
        return dj.find_path(self.graph, source, dest)

    def testPaths(self):
        for pair in itertools.combinations(list(self.graph), 2):
            print("Testing path between: " + pair[0] + " and " + pair[1])
            print(dj.find_path(self.graph, pair[0], pair[1]))

if __name__ == "__main__":
    model = Model()
    print(model.testPaths())
